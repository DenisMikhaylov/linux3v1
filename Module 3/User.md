PAM Module

Установка PAM модуля для управляения паролем пользователя

```
apt-get install libpam-cracklib
```

Настройка сложности пароля

Рассмотрим наиболее распространенные варианты использования этого модуля.:

minlen=n: определяет минимальную длину пароля
dcredit=n: вводить не более n цифр при положительном значении и не менее n цифр при отрицательном значении
ucredit=n: вводить не более n заглавных букв при положительном значении и не менее n заглавных букв при отрицательном значении
lcredit=n: вводить не более n строчных букв при положительном значении и не менее n строчных букв при отрицательном значении
ocredit=n: вводить не более n специальных символов при положительном значении и не менее n специальных символов при отрицательном значении

```
/etc/pam.d/common-password

```
Добавляем строчку
```
password   required   pam_cracklib.so retry=3 minlen=9 ucredit=-1 ocredit=-1 dcredit=-2
```
retry=3 позволяет пользователю ввести пароль не менее трех раз, прежде чем возникнет ошибка

Модуль pam_cracklib предлагает дополнительные параметры для выполнения дополнительных проверок, в том числе:

difok=n: определяет количество смен символов в новом пароле, значение по умолчанию — 5

minclass=n: накладывает не менее n символов из каждого из четырех классов символов

maxrepeat=n: отклоняет пароли, содержащие более n одинаковых последовательных символов; по умолчанию n=0

maxsequence=n: принимает не более n монотонных последовательностей символов, таких как «1234» 
или «abcd»; по умолчанию n=0 означает, что параметр отключен

reject_username: отклоняет пароль, содержащий имя пользователя в прямой или обратной форме
