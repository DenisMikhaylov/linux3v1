Утилита tripwire


Установка
```
# apt install tripwire

# cat /etc/cron.daily/tripwire

# cd /etc/tripwire/
```

Инициализация базы данных файлов системы

```
# tripwire --init
```

Редактирование политик

Читаем сообщения об ошибках инициализации из-за несуществующих файлов, правим текстовый файл политик (можно несколько раз).
```
# vim twpol.txt
```
Обновляем двоичный зашифрованный файл политик и обновляем базу данных.
```
# tripwire --update-policy twpol.txt
```
```
# cd /var/lib/tripwire/
```

Сверяемся с текущей базой данных и генерируем отчет
```
# tripwire --check
```
Просмотр отчета
```
# twprint --print-report --twrfile report/server.corpX.un-NNNNNNN-NNNNNN.twr
```
Автоматическое (не интерактивное) обновление базы данных согласно отчету
```
# tripwire --update -a --twrfile report/server.corpX.un-NNNNNNN-NNNNNN.twr
```


Утилита aide

Установка 
```
# apt install aide
```
```
# less /etc/aide/aide.conf
```
Инициализация базы данных
```
# aideinit
```
```
# ls -l /var/lib/aide
```

Вносим изменения в любой файл
```
# vim /usr/local/sbin/webd
```

Детектируем изменения
```
# aide -c /etc/aide/aide.conf --check
```


Фиксируем текущее состояние системы
```
# aide -c /var/lib/aide/aide.conf.autogenerated --update

# cp /var/lib/aide/aide.db.new /var/lib/aide/aide.db
```
